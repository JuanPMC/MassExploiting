from Exploits.Exploit import *
from googlesearch import search

class Target:
    exploits = list()
    ips = list()

    def __init__(self,file):
        file1 = open(file, 'r')
        lines = file1.readlines()
        for line in lines:
            self.ips.append(line.strip())

    def addExploit(self,exploit):
        self.exploits.append(exploit)

    def removeExploit(self,exploit):
        self.exploits.remove(exploit)

    def runExploitIps(self, exploit):
        for ip in self.ips:
            if exploit.execute(ip):
                print("\033[92m {+}"  + ip + " is vulnerable to " + exploit.name + " \033[00m")
            else:
                print("{-} " + ip + " is NOT vulnerable to " + exploit.name)

    def runExploitsQuerys(self, exploit):
        for target in search(exploit.getGoogle(), tld="co.in", num=1000, pause=30):
            if exploit.execute(target.split('/')[2]):
                print("\033[92m {+}"  + target.split('/')[2] + " is vulnerable to " + exploit.name + " \033[00m")
            else:
                print("{-} " + target.split('/')[2] + " is NOT vulnerable to " + exploit.name)

    def runExploitsListIps(self):
        for exploit in self.exploits:
            self.runExploitIps(exploit)

    def runExploitsGoogle(self):
        for exploit in self.exploits:
            self.runExploitsQuerys(exploit)
